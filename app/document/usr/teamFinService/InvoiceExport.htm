<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="../helpSkin.css" />
	</head>
	<body>
		<div class="header">
			<h1>Invoice Export</h1>
			<div class="description">The purpose of Invoice Export is to export invoice recordes to JD. Edward.</div>
		</div>		
		
		
		<h2>Class</h2>
		<table class="elementTable">
			<tr>
				<th style="width:550px;">Class Name</th>
			</tr>
			<tr>
				<td colspan='5'>TeamFinService</td>				
			</tr>
		</table>
		
		
		<h2>UI Elements</h2>
		<table class="elementTable">
			<tr>
				<th style="width:150px;">UI Element</th>
				<th style="width:120px;">Field Type</th>
				<th style="width:50px;">Mandatory</th>
				<th style="width:100px;">Source</th>				
				<th>Validation</th>				
			</tr>
			<tr>
				<td colspan='5'>There is no UI element</td>					
			</tr>
		</table>
		
		<h2>Export Process</h2>
		<div class="reference">1.	Check if it is time to export</div>
        <div class="reference">2.	Retrieve RevInvoice records by executing RevInvoiceItemsExportSelect</div>
        <div class="reference">3.	Write an invoice record to export file</div>
        <div class="reference">4.	Update export date of the written Invoice record by executing RevInvoiceExportUpdate</div>
        <div class="reference">5.	After all Invoice records are written to export file, close the file</div>


		<h2>Configuration Settings</h2>
		<table class="elementTable">
			<tr>
				<th  style="width:50px;">Configuration Key</th>
				<th  style="width:450px;">Description</th>
			</tr>
			<tr>
				<td>ConnectionString</td>				
				<td>Connection string used to connect to TeamFin database.</td>
			</tr>
			<tr>
				<td>ExportFilePath</td>				
				<td>Complete path of file folder for Invoice Export. This folder is shared with other export processes. </td>
			</tr>
			<tr>
				<td>ExportBackFilePath</td>				
				<td>Complete path of back up file folder for Invoice export. This folder is shared with other export processes. </td>
			</tr>
			<tr>
				<td>ExportAt</td>				
				<td>Time when Invoice Export is executed </td>
			</tr>
		</table>
		
		
		<h2>Data Mapping</h2>
		<table class="elementTable">
        <tr>
            <th style="width: 30px;">Export Field</th>
            <th style="width: 30px;">Database Field</th>
        </tr>
		<tr>
		    <td>RevInviAmount</td><td>RevInvoiceItems.RevInviAmount</td>
		</tr>	
        <tr>
		    <td>INVExport</td><td>RevInvoiceItems.RevInvoiceItem (7 char) +
                                 (RevInvoiceItems.RevInviCreditMemoNumber or RevInvoices.RevInvInvoiceNumber)(10 char) + 
                                AppUnits.AppUniBrief (10 char) + 
                                FscAccountsFscAccCode (10 char) + 
                                RevInvoices.RevInvInvoiceDate (12 char) + 
                                RevInvoiceItems.RevInviAmount  (10 char)+ 
                                RevInvoices.RevInvBillTo (25 char)+ 
                                RevInvoiceItems.RevInvAddress1(30 char) + 
                                RevInvoiceItems.RevInvAddress2 (30 char)+ 
                                ReInvoices.RevInvCity (25 char) + 
                                AppStateTypes.AppStatTitle (25 char)+ 
                                ReInvoices.RevInvPostalCode (10 char) + 
                                ReInvoices.RevInvServicePeriodStartDate (12 char) + 
                                ReInvoices.RevInvServicePeriodEndDate (12 char) + 
                                ReInvoices.RevInvDueDate (12 char) + HcmJobs.HcmJobBrief (8 char) + 
                                HcmJobs.HcmJobBrief (8 char)</td>
		</tr>	
<tr>
		    <td>TFId</td><td>RevInvoiceItems.RevInvoiceItem</td>
		</tr>	
<tr>
		    <td>InvoiceNum</td><td>RevInvoiceItems.RevInviCreditMemoNumber or ReInvoices.RevInvInvoiceNumber</td>
		</tr>	
<tr>
		    <td>Housecode</td><td>AppUnits.AppUniBrief</td>
		</tr>	
<tr>
		    <td>Account</td><td>FscAccounts.FscAccCode</td>
		</tr>	
<tr>
		    <td>InvoiceDate</td><td>RevInvoices.RevInvInvoiceDate</td>
		</tr>	
<tr>
		    <td>Amount</td><td>RevInvoiceItems.RevInviAmount</td>
		</tr>	
<tr>
		    <td>SendTo</td><td>RevInvoices.RevInvBillTo</td>
		</tr>	
<tr>
		    <td>Title_Co</td><td>RevInvoices.RevInvCompany</td>
		</tr>	
<tr>
		    <td>StAddress1</td><td>RevInvoices.RevInvAddress1</td>
		</tr>	
<tr>
		    <td>StAddress2</td><td>RevInvoices.RevInvAddress2</td>
		</tr>	
<tr>
		    <td>City</td><td>RevInvoices.RevInvCity</td>
		</tr>	
<tr>
		    <td>State</td><td>AppStateTypes.AppStatTitle</td>
		</tr>	
        <tr>
		    <td>Zip</td><td>RevInvoices.RevInvPostalCode</td>
		</tr>	
        <tr>
		    <td>ServicePeriodStartDate</td><td>RevInvoices.RevInvServicePeriodStartDate</td>
		</tr>	
        <tr>
		    <td>ServicePeriodEndDate</td><td>RevInvoices.RevInvServicePaeriodEndDate</td>
		</tr>	
        <tr>
		    <td>DueDate</td><td>RevInvoices.RevInvDueDate</td>
		</tr>	
        <tr>
		    <td>Customer</td><td>RevInvoices.HcmJobBrief</td>
		</tr>	
        <tr>
		    <td>SubLedger</td><td>HcmJobs.HcmJobBrief</td>
		</tr>	
		</table>
		
		<h2>Error Messages and Notifications</h2>
		<table class="elementTable">
			<tr>
				<th  style="width:40px;">Error/Event</th>
				<th  style="width:260px;">Message</th>
			</tr>
			<tr>
			    <td>Exceptions</td>
			    <td>Check table AppIEExceptions for exception details (AppIECategory = 6)</td>
			</tr>
			<tr>
			    <td>Imported Number of Records</td>
			    <td>Check table AppIETransactions for total exported records and execution starting/ending time (AppIECategory = 6).</td>
			</tr>
		</table>
		
		<h2>Dependencies</h2>
		<div class="reference">1. Windows Services must be restarted for new configuration settings to take effect.</div>
		<div class="reference">2. Exception and Event logging depends on LogWriter class.</div>
		
		<div class="header">
			<h1>Database Objects</h1>
			<div class="description"></div>
		</div>
		<table class="elementTable">
			<tr>
				<th style="width:50px">Object Types</th>
				<th style="width:250px">Object Names</th>
			</tr>
			<tr>
				<td>Tables</td>
				<td>
				    RevInvoices<br />
				    RevInvoiceItems<br />
				    HcmHouseCode<br />
				    AppUnits<br />
				    AppStateTypes<br />
				    FscAccounts<br />
				    HcmHouseCodeJobs<br />
				    HcmJobs
				</td>
			</tr>
			<tr>
				<td>Stored Procedures</td>
				<td>
				    RevInvoiceItemsExportSelect<br />
				    RevInvoiceExportUpdate
			    </td>
			</tr>
		</table>		
		<h2>See Also</h2>
		<div class="reference"><a href="template.htm">Template</a></div>
	</body>
</html>